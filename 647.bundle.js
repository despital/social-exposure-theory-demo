"use strict";(self.webpackChunksocial_exposure_theory=self.webpackChunksocial_exposure_theory||[]).push([[647],{7647:(e,o,t)=>{t.r(o),t.d(o,{run:()=>p}),t(5259),t(2621);var n=t(7299),s=t(9925),i=t(6430),r=t(1958),a=t(4783);const l={PHASE1_TRIALS:5,PHASE2_TRIALS:5};async function p({assetPaths:e,input:o={},environment:t,title:p,version:c}){const u=(0,n.N3)({show_progress_bar:!0,auto_update_progress_bar:!1,on_finish:function(){u.data.displayData()}}),h=(0,a.MI)(u);let d=(0,a.Oq)();d=(0,a.Gc)(d,u);const m=function(e,o,t){const n=[];let s,i;"equal"===o.condition?(s=.5,i=.5):"red"===o.majorityGroup?(s=.8,i=.2):(s=.2,i=.8);for(let o=0;o<l.PHASE1_TRIALS;o++){const i=Math.round(r.P.FACES_PER_TRIAL*s),a=r.P.FACES_PER_TRIAL-i,l=e.filter(e=>"red"===e.color),p=e.filter(e=>"blue"===e.color),c=t.randomization.sampleWithoutReplacement(l,i),u=t.randomization.sampleWithoutReplacement(p,a),h=t.randomization.shuffle([...c,...u]);n.push({trialNum:o+1,faces:h})}return n}(d,h,u),g=function(e,o){const t=[],n=[{red:4,blue:0},{red:3,blue:1},{red:2,blue:2},{red:1,blue:3},{red:0,blue:4}],s=e.filter(e=>"red"===e.color),i=e.filter(e=>"blue"===e.color);for(let e=0;e<l.PHASE2_TRIALS;e++){const r=n[e],a=o.randomization.sampleWithoutReplacement(s,r.red),l=o.randomization.sampleWithoutReplacement(i,r.blue),p=o.randomization.shuffle([...a,...l]);t.push({trialNum:e+1,composition:`${r.red}R-${r.blue}B`,redCount:r.red,blueCount:r.blue,faces:p})}return t}(d,u);let f=0,_=0,y=0,v=0;console.log("DEMO Experiment initialized:",{conditionCode:h.conditionCode,condition:h.condition,majorityGroup:h.majorityGroup,p1Type:h.p1Type,p2Exposure:h.p2Exposure,phase1Trials:m.length,phase2Trials:g.length});const P=[],b={type:s.A,stimulus:'\n            <h1>Social Exposure Theory Experiment</h1>\n            <h2 style="color: #e74c3c;">DEMO VERSION</h2>\n            <p>This is a simplified demo with only 5 trials per phase.</p>\n            <p>Press any key to begin.</p>\n        ',on_start:function(){u.progressBar.progress=0}};P.push(b);const T="control"===h.p1Type?'<div style="max-width: 800px; margin: auto; text-align: left;">\n            <h2>Phase 1: Learning Task</h2>\n            <p>You will see <strong>4 faces</strong> on each trial.</p>\n            <p>Your task is to choose <strong>one person</strong> to interact with by clicking on their face.</p>\n            <p>After your choice, the reward values for <strong>all four people</strong> will be revealed.</p>\n            <p>Each person can give you either a <strong>reward (+1)</strong> or a <strong>punishment (-5)</strong>.</p>\n            <p><strong>Your goal is to maximize your total score.</strong></p>\n            <p><strong>Demo:</strong> You will complete 5 trials.</p>\n            <p>Press any key to start.</p>\n        </div>':'<div style="max-width: 800px; margin: auto; text-align: left;">\n            <h2>Phase 1: Learning Task</h2>\n            <p>You will see <strong>4 faces</strong> on each trial.</p>\n            <p>Your task is to choose <strong>one person</strong> to interact with by clicking on their face.</p>\n            <p>After your choice, you will receive either a <strong>reward (+1)</strong> or a <strong>punishment (-5)</strong>.</p>\n            <p><strong>Your goal is to maximize your total score.</strong></p>\n            <p><strong>Demo:</strong> You will complete 5 trials.</p>\n            <p>Press any key to start.</p>\n        </div>',A={type:s.A,stimulus:T};P.push(A);const k={timeline:[{type:i.A,images:function(){return u.evaluateTimelineVariable("faces").map(e=>({src:e.imagePath,color:e.color,data:{id:e.id,isGood:e.isGood}}))},prompt:function(){return`\n                <div class="score-display">Phase 1 Score: ${f}</div>\n                <p>Choose a person to interact with:</p>\n            `},image_width:200,image_height:200,grid_columns:2,gap:20,data:function(){return{task:"phase1_choice",phase:1,trial_num:u.evaluateTimelineVariable("trialNum")}},on_finish:function(e){const o=u.evaluateTimelineVariable("faces"),t=o[e.response],n=(0,a.p8)(t);f+=n,y++,e.chosen_face_id=t.id,e.chosen_face_color=t.color,e.chosen_face_is_good=t.isGood,e.outcome=n,e.phase1_score=f,"control"===h.p1Type&&(e.all_outcomes=o.map(e=>({id:e.id,color:e.color,isGood:e.isGood,outcome:e===t?n:(0,a.p8)(e),imagePath:e.imagePath})));const s=y/l.PHASE1_TRIALS;u.progressBar.progress=.4*s}},{type:s.A,stimulus:function(){const e=u.data.get().last(1).values()[0],o=e.outcome;if("control"===h.p1Type){const o=e.all_outcomes,t=e.response;let n=`<div class="score-display">Phase 1 Score: ${f}</div>`;return n+='<div class="control-feedback-grid">',o.forEach((e,o)=>{const s=o===t,i=e.outcome>0?"positive":"negative";n+=`\n                        <div class="control-feedback-cell ${s?"chosen":""}">\n                            <div class="feedback-value ${i}">\n                                ${e.outcome>0?"+"+e.outcome:e.outcome}\n                            </div>\n                        </div>`}),n+="</div>",n}return`\n                    <div class="score-display">Phase 1 Score: ${f}</div>\n                    <div class="feedback ${o>0?"positive":"negative"}">\n                        ${o>0?`+${o}`:o}\n                    </div>\n                    <p>Press any key to continue</p>\n                `},trial_duration:1500,data:{task:"phase1_feedback",phase:1}}],timeline_variables:m};P.push(k);const w={type:s.A,stimulus:function(){return`\n                <h2>Phase 1 Complete!</h2>\n                <p>Your Phase 1 score: <strong>${f}</strong></p>\n                <p>Press any key to continue to Phase 2.</p>\n            `},post_trial_gap:500};P.push(w);const S={type:s.A,stimulus:'\n            <div style="max-width: 800px; margin: auto; text-align: left;">\n                <h2>Phase 2: Partner Choice Task</h2>\n                <p>In this phase, you will see <strong>4 new faces</strong> on each trial.</p>\n                <p>Your task is to choose <strong>one person</strong> you would like to interact with.</p>\n                <p><strong>Note:</strong> You will NOT receive immediate feedback after each choice.</p>\n                <p>At the end of this phase, you will see your total score for Phase 2.</p>\n                <p><strong>Demo:</strong> You will complete 5 trials.</p>\n                <p>Press any key to start Phase 2.</p>\n            </div>\n        ',data:{task:"phase2_instructions"}};P.push(S);const E={timeline:[{type:i.A,images:function(){return u.evaluateTimelineVariable("faces").map(e=>({src:e.imagePath,color:e.color,data:{id:e.id,isGood:e.isGood}}))},prompt:function(){return`\n                <p>Choose a person you would like to interact with:</p>\n                <p style="color: #666; font-size: 14px;">Trial ${v+1} of ${l.PHASE2_TRIALS}</p>\n            `},image_width:200,image_height:200,grid_columns:2,gap:20,data:function(){return{task:"phase2_choice",phase:2,trial_num:u.evaluateTimelineVariable("trialNum"),composition:u.evaluateTimelineVariable("composition"),red_count:u.evaluateTimelineVariable("redCount"),blue_count:u.evaluateTimelineVariable("blueCount")}},on_finish:function(e){const o=u.evaluateTimelineVariable("faces")[e.response],t=(0,a.p8)(o);_+=t,v++,e.chosen_face_id=o.id,e.chosen_face_color=o.color,e.chosen_face_is_good=o.isGood,e.outcome=t,e.phase2_score=_;const n=v/l.PHASE2_TRIALS*.6;u.progressBar.progress=.4+n}}],timeline_variables:g};P.push(E);const $={type:s.A,stimulus:function(){return`\n                <h2>Phase 2 Complete!</h2>\n                <p>Your Phase 2 score: <strong>${_}</strong></p>\n                <p>Press any key to continue.</p>\n            `},post_trial_gap:500};P.push($);const x={type:s.A,stimulus:function(){return`\n                <h2>Demo Complete!</h2>\n                <h3>Summary</h3>\n                <p>Phase 1 score: <strong>${f}</strong> (${l.PHASE1_TRIALS} trials)</p>\n                <p>Phase 2 score: <strong>${_}</strong> (${l.PHASE2_TRIALS} trials)</p>\n                <p>Total combined score: <strong>${f+_}</strong></p>\n                <hr>\n                <p style="color: #666;">Code: ${h.conditionCode} | Condition: ${h.condition}, Majority: ${h.majorityGroup}, P1 Type: ${h.p1Type}, P2 Exposure: ${h.p2Exposure}</p>\n                <p>Press any key to view data.</p>\n            `},post_trial_gap:500};P.push(x),await u.run(P)}}}]);