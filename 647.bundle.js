"use strict";(self.webpackChunksocial_exposure_theory=self.webpackChunksocial_exposure_theory||[]).push([[647],{7647:(e,t,n)=>{n.r(t),n.d(t,{run:()=>c}),n(5259),n(2621);var o=n(7299),s=n(9925),i=n(4621),a=n(6430),r=n(1958),p=n(4783);const l=5;async function c({assetPaths:e,input:t={},environment:n,title:c,version:u}){const h=(0,o.N3)({show_progress_bar:!0,auto_update_progress_bar:!1,on_finish:function(){h.data.displayData()}}),d=(0,p.MI)(h);let m=(0,p.Oq)(h,d);m=(0,p.Gc)(m,h);const g=(0,p.Wj)(h),y=(0,p.T4)(m,h).slice(0,l),f=(0,p._)(g,d,h).slice(0,l),_=(0,p.Zn)(y,m,h).slice(0,l);let b=0,v=0,k=0,x=0,w=0;console.log("DEMO Experiment initialized:",{conditionCode:d.conditionCode,condition:d.condition,majorityGroup:d.majorityGroup,p1Type:d.p1Type,p2Exposure:d.p2Exposure,phase1Trials:y.length,phase2Trials:f.length,phase3Trials:_.length});const P=[],T={type:s.A,stimulus:`\n            <h1>Social Exposure Theory Experiment</h1>\n            <h2 style="color: #e74c3c;">DEMO VERSION</h2>\n            <p>This is a simplified in-lab demo with ${l} trials per phase.</p>\n            <p style="color: #666;">Condition: ${d.conditionCode} | P1: ${d.p1Type} | P2 Exposure: ${d.p2Exposure}</p>\n            <p>Press any key to begin.</p>\n        `,on_start:function(){h.progressBar.progress=0}};P.push(T);const $="control"===d.p1Type?`<div style="max-width: 800px; margin: auto; text-align: left;">\n            <h2>Phase 1: Learning Task</h2>\n            <p>You will see <strong>4 faces</strong> on each trial.</p>\n            <p>Your task is to choose <strong>one person</strong> to interact with by clicking on their face.</p>\n            <p>After your choice, the reward values for <strong>all four people</strong> will be revealed.</p>\n            <p>Each person can give you either a <strong>reward (+1)</strong> or a <strong>punishment (-5)</strong>.</p>\n            <p><strong>Your goal is to maximize your total score.</strong></p>\n            <p><em>Demo: ${l} trials.</em></p>\n            <p>Press any key to start.</p>\n        </div>`:`<div style="max-width: 800px; margin: auto; text-align: left;">\n            <h2>Phase 1: Learning Task</h2>\n            <p>You will see <strong>4 faces</strong> on each trial.</p>\n            <p>Your task is to choose <strong>one person</strong> to interact with by clicking on their face.</p>\n            <p>After your choice, you will receive either a <strong>reward (+1)</strong> or a <strong>punishment (-5)</strong>.</p>\n            <p><strong>Your goal is to maximize your total score.</strong></p>\n            <p><em>Demo: ${l} trials.</em></p>\n            <p>Press any key to start.</p>\n        </div>`,E={type:s.A,stimulus:$,data:{task:"phase1_instructions"}};P.push(E);const A={timeline:[{type:a.A,images:function(){return h.evaluateTimelineVariable("faces").map(e=>({src:e.imagePath,color:e.color,data:{id:e.id,isGood:e.isGood}}))},prompt:function(){return"<p>Choose a person to interact with by clicking on a face:</p>"},image_width:200,image_height:200,grid_columns:2,gap:20,data:function(){return{task:"choice",phase:1,block:h.evaluateTimelineVariable("block"),trial_in_block:h.evaluateTimelineVariable("trialInBlock")}},on_finish:function(e){const t=h.evaluateTimelineVariable("faces"),n=t[e.response],o=(0,p.p8)(n);b+=o,k++,e.chosen_face_id=n.id,e.chosen_face_color=n.color,e.chosen_face_is_good=n.isGood,e.outcome=o,e.total_score=b,"control"===d.p1Type&&(e.all_outcomes=t.map(e=>({id:e.id,color:e.color,isGood:e.isGood,outcome:e===n?o:(0,p.p8)(e),imagePath:e.imagePath})))}},{type:s.A,stimulus:function(){const e=h.data.get().last(1).values()[0],t=e.outcome;if("control"===d.p1Type){const t=e.all_outcomes,n=e.response;let o='<div class="control-feedback-grid">';return t.forEach((e,t)=>{const s=t===n,i=e.outcome>0?"positive":"negative";o+=`\n                        <div class="control-feedback-cell ${s?"chosen":""}">\n                            <div class="feedback-value ${i}">\n                                ${e.outcome>0?"+"+e.outcome:e.outcome}\n                            </div>\n                        </div>`}),o+="</div>",o}return`\n                    <div class="feedback ${t>0?"positive":"negative"}">\n                        ${t>0?`+${t}`:t}\n                    </div>\n                `},choices:"NO_KEYS",trial_duration:1e3,data:{task:"feedback",phase:1},on_finish:function(){h.progressBar.progress=k/l*.6}}],timeline_variables:y};P.push(A);const V={type:s.A,stimulus:"\n            <h2>Phase 1 Complete!</h2>\n            <p>Great job! You've finished the first part of the experiment.</p>\n            <p>Press any key to continue.</p>\n        ",post_trial_gap:500,data:{task:"phase1_complete"}};P.push(V);let C=null;const G={type:s.A,stimulus:function(){return'\n                <div id="break-container">\n                    <h2>Break Time!</h2>\n                    <p>You\'ve completed Phase 1. Please take a short break before Phase 2.</p>\n                    <p>The experiment will continue in:</p>\n                    <div id="countdown-timer" style="font-size: 48px; font-weight: bold; margin: 30px 0;">10</div>\n                    <p style="color: #666;"><em>(Demo: 10 s break)</em> — or press <strong>spacebar</strong> to continue now</p>\n                </div>\n            '},choices:[" "],trial_duration:1e4,on_load:function(){let e=10;const t=document.getElementById("countdown-timer");C=setInterval(()=>{e--,t&&(t.textContent=e),e<=0&&clearInterval(C)},1e3)},on_finish:function(){C&&(clearInterval(C),C=null)},data:{task:"phase2_break"}};P.push(G);const I={type:s.A,stimulus:`\n            <div style="max-width: 800px; margin: auto; text-align: left;">\n                <h2>Phase 2 Instructions</h2>\n                <p>In this phase, you will see <strong>new faces</strong> one at a time.</p>\n                <p>For each face, please use the slider to indicate how willing you are to <strong>approach</strong> or <strong>avoid</strong> this person.</p>\n                <p><strong>Note:</strong> You will NOT receive feedback after each rating.</p>\n                <p><em>Demo: ${l} trials.</em></p>\n                <p>Press any key to start Phase 2.</p>\n            </div>\n        `,data:{task:"phase2_instructions"}};P.push(I);const D={timeline:[{type:i.A,stimulus:function(){const e=h.evaluateTimelineVariable("face");return`\n                <div style="text-align: center;">\n                    <img src="${e.imagePath}"\n                         style="width: 300px; height: 300px; border: 10px solid ${e.color}; border-radius: 10px; margin-bottom: 30px;">\n                </div>\n            `},labels:["Avoid","Neutral","Approach"],min:0,max:100,slider_start:50,button_label:"Submit",require_movement:!0,prompt:"<p>How willing are you to approach or avoid this person?</p>",data:function(){const e=h.evaluateTimelineVariable("face");return{task:"phase2_slider",phase:2,face_id:e.id,face_color:e.color,face_is_good:e.isGood,image_path:e.imagePath}},on_finish:function(e){const t=h.evaluateTimelineVariable("face");e.slider_rating=e.response;const n=e.slider_rating;let o;50===n?(o=0,e.correct=null):t.isGood?(e.correct=n>50,o=n>50?r.P.REWARD_VALUE:r.P.PUNISHMENT_VALUE):(e.correct=n<50,o=n<50?r.P.REWARD_VALUE:r.P.PUNISHMENT_VALUE),v+=o,e.outcome=o,e.phase2_score=v,x++,h.progressBar.progress=.6+x/l*.1,delete e.stimulus,delete e.slider_start,delete e.plugin_version,delete e.response,delete e.trial_type}}],timeline_variables:f};P.push(D);const Y={type:s.A,stimulus:"\n            <h2>Phase 2 Complete!</h2>\n            <p>Thank you for completing your ratings!</p>\n            <p>Press any key to continue.</p>\n        ",post_trial_gap:500,data:{task:"phase2_summary"}};P.push(Y);const N={type:s.A,stimulus:`\n            <div style="max-width: 800px; margin: auto; text-align: left;">\n                <h2>Phase 3 Instructions</h2>\n                <p>In this final phase, we will show you the faces you encountered during Phase 1.</p>\n                <p>For each face, use the slider to indicate:</p>\n                <ul>\n                    <li>What is the probability (0–100%) that this person will give you a <strong>punishment</strong>?</li>\n                </ul>\n                <p>The slider starts at 50%. You must move it before you can continue.</p>\n                <p>There are no right or wrong answers — we're interested in your impressions.</p>\n                <p><em>Demo: ${l} trials.</em></p>\n                <p>Press any key to start Phase 3.</p>\n            </div>\n        `,data:{task:"phase3_instructions"}};P.push(N);const B={timeline:[{type:i.A,stimulus:function(){const e=h.evaluateTimelineVariable("face");return`\n                <div style="text-align: center;">\n                    <img src="${e.imagePath}"\n                         style="width: 300px; height: 300px; border: 10px solid ${e.color}; border-radius: 10px; margin-bottom: 20px;">\n                    <h3 style="margin-top: 10px;">What is the probability that this person will give you a <strong>punishment</strong>?</h3>\n                </div>\n            `},min:0,max:100,start:50,step:1,slider_width:500,labels:["0%","25%","50%","75%","100%"],require_movement:!0,data:function(){return{task:"phase3_probability",phase:3,face_id:h.evaluateTimelineVariable("face").id,face_color:h.evaluateTimelineVariable("face").color,face_is_good:h.evaluateTimelineVariable("face").isGood}},on_finish:function(e){e.probability_punishment=e.response,w++,h.progressBar.progress=.7+w/l*.3}}],timeline_variables:_};P.push(B);const S={type:s.A,stimulus:"\n            <h2>Phase 3 Complete!</h2>\n            <p>Thank you for providing your ratings.</p>\n            <p>Press any key to continue.</p>\n        ",post_trial_gap:500,data:{task:"phase3_complete"}};P.push(S);const j={type:s.A,stimulus:function(){return`\n                <h2>Demo Complete!</h2>\n                <h3>Summary</h3>\n                <p>Phase 1 score: <strong>${b}</strong> (${l} trials)</p>\n                <p>Phase 2 score: <strong>${v}</strong> (${l} approach/avoidance ratings)</p>\n                <p>Phase 3: ${l} punishment probability estimates</p>\n                <hr>\n                <p style="color: #666; font-size: 13px;">\n                    Code: ${d.conditionCode} &nbsp;|&nbsp;\n                    Condition: ${d.condition} &nbsp;|&nbsp;\n                    Majority: ${d.majorityGroup} &nbsp;|&nbsp;\n                    P1 Type: ${d.p1Type} &nbsp;|&nbsp;\n                    P2 Exposure: ${d.p2Exposure}\n                </p>\n                <p>Press any key to view raw data.</p>\n            `},post_trial_gap:500};P.push(j),await h.run(P)}}}]);